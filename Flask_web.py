from datetime import timedeltafrom django.shortcuts import renderfrom flask import Flask, redirect, render_template, request, url_for, sessionfrom eggprice_spider import get_egg_pricefrom login_database import insert_data_regist, get_user_login, get_passwd_loginfrom cbadata_spider import get_cba_datafrom spider_database import get_data, get_data1from utils import get_time, is_loginfrom flask_bootstrap import Bootstrapapp = Flask(__name__)bootstrap = Bootstrap(app)@app.route('/')def hello_world():    # return 'Hello World!'    return redirect('/login')@app.route('/login')def login():    return render_template('login.html')@app.route('/regist')def afhldkh():    return render_template('regist.html')@app.route('/index',methods=['GET','POST'])def afhldfdgkh():    if request.values.get('phonenumber'):        name= request.values.get('username')        passwd = request.values.get('password')        phone = request.values.get('phonenumber')        #数据存入数据库        insert_data_regist(name,passwd,phone)        return redirect('/login')    else:        #登陆情况下先得到用户名        a = request.values.get('username')        b = request.values.get('password')        #可以取到        session['user'] = a        session.permanent = True        app.permanent_session_lifetime = timedelta(minutes=0.2)        #从数据库取该用户名的信息        c = get_user_login()        d = get_passwd_login(a)        if a in c:            if b in d:                return redirect(url_for('main'))            else:                return render_template('error.html',error='用户名或密码错误')        else:            return render_template('error.html',error='用户名或密码错误')@app.route('/main')@is_logindef main():    qaz = session['user']    return render_template('main.html',data=get_cba_data(),aaa=qaz)@app.route('/logout')def log_out():    return redirect('/login')@app.route('/main/detial')@is_logindef det():    qaz = session['user']    return render_template('main01.html',data=get_data1(),aaa=qaz)@app.route('/eggprice')@is_logindef egg():    qaz = session['user']    return render_template('main1.html',data=get_egg_price(),aaa=qaz)if __name__ == '__main__':    app.debug = True    app.secret_key = 'qweasdzxc'    app.run(port=1000)